@{
    ViewData["Title"] = "ALIS Demos";
}

<div class="row mb-4">
    <div class="col-12">
        <h2 class="mb-0">ALIS Framework Demos</h2>
        <p class="text-muted">Interactive demonstrations of ALIS features with Syncfusion Essential JS 2 controls</p>
    </div>
</div>

<!-- Demo 1: Debounced Search with Syncfusion TextBox -->
<div class="demo-section">
    <h4>1. Debounced Search (Syncfusion TextBox)</h4>
    <p>Type in the search box to see debounced requests in action. ALIS waits 300ms after you stop typing before sending the request.</p>
    
    <div class="row">
        <div class="col-md-8">
            <div class="search-container">
                <ejs-textbox id="searchTextBox"
                             name="query"
                             placeholder="Search residents by name or room..."
                             showClearButton="true"
                             data-alis-get="/Residents/Search"
                             data-alis-trigger="input delay:300ms"
                             data-alis-target="#search-results"
                             data-alis-collect="self"
                             data-alis-indicator="is-loading, #search-spinner">
                </ejs-textbox>
                <span class="spinner" id="search-spinner"></span>
            </div>
        </div>
    </div>
    
    <div id="search-results" class="mt-3">
        <p class="text-muted">Start typing to search...</p>
    </div>
    
    <div class="code-sample mt-3">
        <pre>&lt;ejs-textbox name="query"
       data-alis-get="/Residents/Search"
       data-alis-trigger="input delay:300ms"
       data-alis-target="#search-results"
       data-alis-collect="self" /&gt;</pre>
    </div>
</div>

<!-- Demo 2: Form Validation with Syncfusion Controls -->
<div class="demo-section">
    <h4>2. Form Validation (Syncfusion Controls + FluentValidation â†’ ProblemDetails)</h4>
    <p>Server-side validation using FluentValidation returns RFC 7807 ProblemDetails. ALIS displays errors next to Syncfusion fields.</p>
    
    <form data-alis-post="/Residents/Create"
          data-alis-validate="true"
          data-alis-target="#validation-result"
          data-alis-swap="innerHTML"
          data-alis-on-after="handleSuccess">
        
        <div class="row">
            <div class="col-md-4 mb-3">
                <label class="form-label">First Name</label>
                <ejs-textbox id="firstNameInput"
                             name="FirstName"
                             placeholder="Enter first name"
                             data-val="true"
                             data-val-required="First name is required"
                             data-val-minlength="Minimum 2 characters"
                             data-val-minlength-min="2">
                </ejs-textbox>
                <span data-valmsg-for="FirstName" class="field-validation-valid text-danger"></span>
            </div>
            <div class="col-md-4 mb-3">
                <label class="form-label">Last Name</label>
                <ejs-textbox id="lastNameInput"
                             name="LastName"
                             placeholder="Enter last name"
                             data-val="true"
                             data-val-required="Last name is required">
                </ejs-textbox>
                <span data-valmsg-for="LastName" class="field-validation-valid text-danger"></span>
            </div>
            <div class="col-md-4 mb-3">
                <label class="form-label">Room Number</label>
                <ejs-textbox id="roomNumberInput"
                             name="RoomNumber"
                             placeholder="e.g., A123"
                             data-val="true"
                             data-val-required="Room number is required"
                             data-val-regex="Format: A123 (letter + 3 digits)"
                             data-val-regex-pattern="^[A-Z]\d{3}$">
                </ejs-textbox>
                <span data-valmsg-for="RoomNumber" class="field-validation-valid text-danger"></span>
            </div>
        </div>
        
        <ejs-button id="submitBtn" type="submit" cssClass="e-primary" isPrimary="true" content="Submit (Will Validate)">
        </ejs-button>
    </form>
    
    <div id="validation-result" class="mt-3"></div>
    
    <div class="code-sample mt-3">
        <pre>&lt;form data-alis-post="/Residents/Create"
      data-alis-validate="true"
      data-alis-on-after="handleSuccess"&gt;
    &lt;ejs-textbox name="FirstName" 
           data-val="true"
           data-val-required="First name is required" /&gt;
    &lt;span data-valmsg-for="FirstName"&gt;&lt;/span&gt;
&lt;/form&gt;</pre>
    </div>
</div>

<!-- Demo 3: Cascading Dropdowns with Syncfusion DropDownList -->
<div class="demo-section">
    <h4>3. Cascading Dropdowns (Syncfusion DropDownList)</h4>
    <p>Select a building to load floors, then select a floor to load wings. Each Syncfusion dropdown triggers an ALIS request.</p>
    
    <div class="row">
        <div class="col-md-4 mb-3">
            <label class="form-label">Building</label>
            <ejs-dropdownlist id="buildingDropdown"
                              name="buildingId"
                              placeholder="Select Building"
                              index="0"
                              data-alis-get="/Facility/Floors"
                              data-alis-trigger="change"
                              data-alis-target="#floorDropdownContainer"
                              data-alis-collect="self"
                              data-alis-on-after="clearWings">
                <e-dropdownlist-fields text="Text" value="Value"></e-dropdownlist-fields>
                <e-data-manager json="@(new[] { 
                    new { Text = "-- Select Building --", Value = "" },
                    new { Text = "Main Building (MAIN)", Value = "1" },
                    new { Text = "Healthcare Center (HC)", Value = "2" },
                    new { Text = "Independent Living (IL)", Value = "3" }
                })"></e-data-manager>
            </ejs-dropdownlist>
        </div>
        <div class="col-md-4 mb-3">
            <label class="form-label">Floor</label>
            <div id="floorDropdownContainer">
                <ejs-dropdownlist id="floorDropdown"
                                  name="floorId"
                                  placeholder="Select Floor"
                                  enabled="false"
                                  data-alis-get="/Facility/Wings"
                                  data-alis-trigger="change"
                                  data-alis-target="#wingDropdownContainer"
                                  data-alis-collect="self">
                    <e-dropdownlist-fields text="Text" value="Value"></e-dropdownlist-fields>
                    <e-data-manager json="@(new[] { new { Text = "-- Select Floor --", Value = "" } })"></e-data-manager>
                </ejs-dropdownlist>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <label class="form-label">Wing</label>
            <div id="wingDropdownContainer">
                <ejs-dropdownlist id="wingDropdown"
                                  name="wingId"
                                  placeholder="Select Wing"
                                  enabled="false">
                    <e-dropdownlist-fields text="Text" value="Value"></e-dropdownlist-fields>
                    <e-data-manager json="@(new[] { new { Text = "-- Select Wing --", Value = "" } })"></e-data-manager>
                </ejs-dropdownlist>
            </div>
        </div>
    </div>
    
    <div class="code-sample mt-3">
        <pre>&lt;ejs-dropdownlist id="buildingDropdown"
        data-alis-get="/Facility/Floors"
        data-alis-trigger="change"
        data-alis-target="#floorDropdownContainer"
        data-alis-collect="self"&gt;
&lt;/ejs-dropdownlist&gt;</pre>
    </div>
</div>

<!-- Demo 4: Delete with Confirmation -->
<div class="demo-section">
    <h4>4. Delete with Confirmation Modal</h4>
    <p>Click delete to see the custom confirmation modal. ALIS waits for user confirmation before proceeding.</p>
    
    <div class="d-flex gap-2">
        <ejs-button id="deleteBtn" 
                    cssClass="e-danger"
                    content="ðŸ—‘ï¸ Delete Resident"
                    data-alis-delete="/Residents/Delete/999"
                    data-alis-confirm="deleteConfirm"
                    data-alis-confirm-message="Are you sure you want to delete this resident? This action cannot be undone."
                    data-alis-target="#delete-result"
                    data-alis-swap="innerHTML">
        </ejs-button>
        <span id="delete-result" class="align-self-center text-muted">Click to test confirmation</span>
    </div>
    
    <div class="code-sample mt-3">
        <pre>&lt;ejs-button data-alis-delete="/Residents/Delete/999"
        data-alis-confirm="deleteConfirm"
        data-alis-confirm-message="Are you sure?"
        data-alis-target="#result"&gt;
    Delete
&lt;/ejs-button&gt;</pre>
    </div>
</div>

<!-- Demo 5: Syncfusion Controls with ALIS Validation -->
<div class="demo-section">
    <h4>5. Full Syncfusion Form (DropDownList, NumericTextBox, DatePicker, CheckBox)</h4>
    <p>ALIS includes a Syncfusion adapter that correctly reads values from EJ2 components and applies validation states.</p>
    
    <form id="syncfusionForm"
          data-alis-post="/Vitals/Record"
          data-alis-validate="true"
          data-alis-target="#syncfusion-result"
          data-alis-swap="none"
          data-alis-on-after="handleSuccess">
        
        <div class="row">
            <div class="col-md-3 mb-3">
                <label class="form-label">Resident</label>
                <ejs-dropdownlist id="residentDropdown" 
                                  name="ResidentId"
                                  placeholder="Select a resident"
                                  data-val="true"
                                  data-val-required="Please select a resident">
                    <e-dropdownlist-fields text="Text" value="Value"></e-dropdownlist-fields>
                    <e-data-manager json="@(new[] { 
                        new { Text = "Eleanor Thompson (A101)", Value = "1" },
                        new { Text = "Robert Martinez (A102)", Value = "2" },
                        new { Text = "Margaret Chen (B201)", Value = "3" },
                        new { Text = "William Johnson (C301)", Value = "4" }
                    })"></e-data-manager>
                </ejs-dropdownlist>
                <span data-valmsg-for="ResidentId" class="field-validation-valid text-danger"></span>
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Systolic BP (mmHg)</label>
                <ejs-numerictextbox id="systolicInput" 
                                    name="BloodPressureSystolic"
                                    min="60"
                                    max="250"
                                    step="1"
                                    format="n0"
                                    placeholder="Systolic"
                                    data-val="true"
                                    data-val-required="Systolic BP is required"
                                    data-val-range="Must be between 60 and 250"
                                    data-val-range-min="60"
                                    data-val-range-max="250">
                </ejs-numerictextbox>
                <span data-valmsg-for="BloodPressureSystolic" class="field-validation-valid text-danger"></span>
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Diastolic BP (mmHg)</label>
                <ejs-numerictextbox id="diastolicInput" 
                                    name="BloodPressureDiastolic"
                                    min="40"
                                    max="150"
                                    step="1"
                                    format="n0"
                                    placeholder="Diastolic"
                                    data-val="true"
                                    data-val-required="Diastolic BP is required"
                                    data-val-range="Must be between 40 and 150"
                                    data-val-range-min="40"
                                    data-val-range-max="150">
                </ejs-numerictextbox>
                <span data-valmsg-for="BloodPressureDiastolic" class="field-validation-valid text-danger"></span>
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Heart Rate (bpm)</label>
                <ejs-numerictextbox id="heartRateInput" 
                                    name="HeartRate"
                                    min="30"
                                    max="220"
                                    step="1"
                                    format="n0"
                                    placeholder="Heart Rate"
                                    data-val="true"
                                    data-val-required="Heart rate is required"
                                    data-val-range="Must be between 30 and 220"
                                    data-val-range-min="30"
                                    data-val-range-max="220">
                </ejs-numerictextbox>
                <span data-valmsg-for="HeartRate" class="field-validation-valid text-danger"></span>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-3 mb-3">
                <label class="form-label">Temperature (Â°F)</label>
                <ejs-numerictextbox id="temperatureInput" 
                                    name="Temperature"
                                    min="95"
                                    max="108"
                                    step="0.1"
                                    format="n1"
                                    placeholder="Temperature"
                                    data-val="true"
                                    data-val-required="Temperature is required"
                                    data-val-range="Must be between 95 and 108"
                                    data-val-range-min="95"
                                    data-val-range-max="108">
                </ejs-numerictextbox>
                <span data-valmsg-for="Temperature" class="field-validation-valid text-danger"></span>
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Oxygen Saturation (%)</label>
                <ejs-numerictextbox id="oxygenInput" 
                                    name="OxygenSaturation"
                                    min="70"
                                    max="100"
                                    step="1"
                                    format="n0"
                                    placeholder="SpO2"
                                    data-val="true"
                                    data-val-required="SpO2 is required"
                                    data-val-range="Must be between 70 and 100"
                                    data-val-range-min="70"
                                    data-val-range-max="100">
                </ejs-numerictextbox>
                <span data-valmsg-for="OxygenSaturation" class="field-validation-valid text-danger"></span>
            </div>
            <div class="col-md-3 mb-3">
                <label class="form-label">Recorded Date</label>
                <ejs-datepicker id="recordedDate" 
                                name="RecordedAt"
                                value="DateTime.Today"
                                format="MM/dd/yyyy"
                                placeholder="Select date"
                                data-val="true"
                                data-val-required="Date is required">
                </ejs-datepicker>
                <span data-valmsg-for="RecordedAt" class="field-validation-valid text-danger"></span>
            </div>
            <div class="col-md-3 mb-3 d-flex align-items-end">
                <ejs-checkbox id="urgentCheckbox" 
                              name="IsUrgent"
                              label="Mark as Urgent"
                              cssClass="e-warning">
                </ejs-checkbox>
            </div>
        </div>
        
        <ejs-button id="recordVitalsBtn" type="submit" cssClass="e-primary" isPrimary="true" content="Record Vitals">
        </ejs-button>
    </form>
    
    <div id="syncfusion-result" class="mt-3"></div>
</div>

<!-- Demo 6: Hyperlink Navigation -->
<div class="demo-section">
    <h4>6. Hyperlink Navigation (Partial Page Updates)</h4>
    <p>Standard links enhanced with ALIS to load content without full page reload.</p>
    
    <div class="d-flex gap-3 mb-3">
        <a href="#"
           data-alis-get="/Residents/Details/1"
           data-alis-target="#resident-details"
           data-alis-indicator="is-loading">
            View Eleanor Thompson
        </a>
        <a href="#"
           data-alis-get="/Residents/Details/2"
           data-alis-target="#resident-details"
           data-alis-indicator="is-loading">
            View Robert Martinez
        </a>
        <a href="#"
           data-alis-get="/Residents/Details/3"
           data-alis-target="#resident-details"
           data-alis-indicator="is-loading">
            View Margaret Chen
        </a>
    </div>
    
    <div id="resident-details" class="border rounded p-3 bg-light">
        <p class="text-muted mb-0">Click a link above to load resident details</p>
    </div>
    
    <div class="code-sample mt-3">
        <pre>&lt;a href="#"
   data-alis-get="/Residents/Details/1"
   data-alis-target="#resident-details"&gt;
    View Resident
&lt;/a&gt;</pre>
    </div>
</div>

<!-- Note: Syncfusion scripts are loaded via <ejs-scripts> in _Layout.cshtml -->
